<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Check and update schema descriptions — validateSchema • tabshiftr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Check and update schema descriptions — validateSchema"><meta property="og:description" content="This function takes a raw schema description and updates values that were
only given as wildcard or implied values. It is automatically called by
reorganise, but can also be used in concert with the getters to debug
a schema."><meta property="og:image" content="http://EhrmannS.github.io/tabshiftr/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tabshiftr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/tabshiftr.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://www.twitter.com/DerEhrmann" class="external-link">
    <span class="fa fa-twitter fa-lg"></span>

  </a>
</li>
<li>
  <a href="https://github.com/EhrmannS/tabshiftr" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Check and update schema descriptions</h1>
    <small class="dont-index">Source: <a href="https://github.com/luckinet/tabshiftr/blob/master/R/validateSchema.R" class="external-link"><code>R/validateSchema.R</code></a></small>
    <div class="hidden name"><code>validateSchema.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function takes a raw schema description and updates values that were
only given as wildcard or implied values. It is automatically called by
<code>reorganise</code>, but can also be used in concert with the getters to debug
a schema.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">validateSchema</span><span class="op">(</span>schema <span class="op">=</span> <span class="cn">NULL</span>, input <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-schema">schema<a class="anchor" aria-label="anchor" href="#arg-schema"></a></dt>
<dd><p>[<code>symbol(1)</code>]<br> the schema description.</p></dd>


<dt id="arg-input">input<a class="anchor" aria-label="anchor" href="#arg-input"></a></dt>
<dd><p>[<code>data.frame(1)</code>]<br> an input for which to check a schema
description.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An updated schema description</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The core idea of a schema description is that it can be written in a
  very generic way, as long as it describes sufficiently where in a table
  what variable can be found. A very generic way can be via using the
  function <code><a href="dot-find.html">.find</a></code> to identify the initially unknown
  cell-locations of a variable on-the-fly, for example when it is merely
  known that a variable must be in the table, but not where it is.</p>
<p><code>validateSchema</code> matches a schema with an input table and inserts the
  accordingly evaluated positions (of clusters, filters and variables),
  adapts some of the meta-data and ensures formal consistency of the schema.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># build a schema for an already tidy table</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">tidyTab</span> <span class="op">&lt;-</span> <span class="va">tabs2shift</span><span class="op">$</span><span class="va">tidy</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    X1          X2     X3          X4             X5        X6         X7       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> territories period commodities other_observed harvested production empty_col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> unit 1      year 1 soybean     xyz            1111      1112       <span style="color: #BB0000;">NA</span>       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> unit 1      year 1 maize       xyz            1121      1122       <span style="color: #BB0000;">NA</span>       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> unit 1      year 2 soybean     xyz            1211      1212       <span style="color: #BB0000;">NA</span>       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> unit 1      year 2 maize       xyz            1221      1222       <span style="color: #BB0000;">NA</span>       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> unit 2      year 1 soybean     xyz            2111      2112       <span style="color: #BB0000;">NA</span>       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> unit 2      year 1 maize       xyz            2121      2122       <span style="color: #BB0000;">NA</span>       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> unit 2      year 2 soybean     xyz            2211      2212       <span style="color: #BB0000;">NA</span>       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> unit 2      year 2 maize       xyz            2221      2222       <span style="color: #BB0000;">NA</span>       </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">schema</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="setIDVar.html">setIDVar</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"territories"</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="setIDVar.html">setIDVar</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"year"</span>, col <span class="op">=</span> <span class="fu"><a href="dot-find.html">.find</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"period"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="setIDVar.html">setIDVar</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"commodities"</span>, col <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="setObsVar.html">setObsVar</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"harvested"</span>, col <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="setObsVar.html">setObsVar</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"production"</span>, col <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># before ...</span></span></span>
<span class="r-in"><span><span class="va">schema</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1 cluster (whole spreadsheet)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    variable      type       col       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ------------- ---------- --------  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #BBBB00;">territories</span>   id         1        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #BBBB00;">year</span>          id         period   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #BBBB00;">commodities</span>   id         3        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #BBBB00;">harvested</span>     observed   5        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #BBBB00;">production</span>    observed   6        </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ... after</span></span></span>
<span class="r-in"><span><span class="fu">validateSchema</span><span class="op">(</span>schema <span class="op">=</span> <span class="va">schema</span>, input <span class="op">=</span> <span class="va">tidyTab</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1 cluster</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     origin : 1|1  (row|col)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   filter  [rows 2, 3, 4, 5, 7, 8, 9, 10]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    variable      type       top   col    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ------------- ---------- ----- -----  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #BBBB00;">territories</span>   id               1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #BBBB00;">year</span>          id               2     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #BBBB00;">commodities</span>   id               3     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #BBBB00;">harvested</span>     observed   1     5     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #BBBB00;">production</span>    observed   1     6     </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://orcid.org/0000-0002-2958-0796" class="external-link">Steffen Ehrmann</a>, <a href="https://orcid.org/0000-0003-3927-5856" class="external-link">Carsten Meyer</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

